{"config":{"lang":["en"],"separator":"[\\s\\-\\.]","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":""},{"location":"#introduction","title":"Introduction","text":"<p>Open Banking Connector is a fully open-source, free-to-use UK Open Banking client (connection layer) that simplifies connections to UK Open Banking APIs.</p> <p>It is self-deployed (runs as a component in your backend infrastructure) and released via a Docker image built entirely from the public source code. Because it runs locally, it has great performance (including low latency) as well as privacy/security benefits because bank data is not passed through another organisation. And fully-transparent source code allows you to see what the code is doing and even build it yourself using the included Dockerfile.</p> <p>It provides internal HTTP APIs based on the UK Open Banking APIs but with two major simplifications:</p> <ol> <li>bank profiles allow Open Banking Connector to support differing bank implementations and behaviours including non-uniform spec versions and quirks/unexpected behaviours. This means you see a single, unified multi-bank API with these issues taken care of saving the considerable effort required for individual bank integrations.</li> <li>security profile (auth) concerns including access token acquisition and management are taken care of transparently (invisibly) isolating these from the rest of your backend and saving you the effort of implementing these.</li> </ol> <p>It is designed for use in the cloud and is ideally suited for deployment in a Kubernetes cluster.</p>"},{"location":"#uses","title":"Uses","text":"<p>Open Banking Connector can be used:</p> <ul> <li>as a connectivity layer enabling your Open Banking application to connect to UK bank APIs</li> <li>as a tool for creating and managing bank registrations (OAuth2 clients) for use by other software (perhaps your own).</li> </ul> <p>The Open Banking Connector repo also contains a .NET project for bank tests. This is used in the development of Open Banking Connector as a regression test suite. Please contact us if you are interested in using this.</p>"},{"location":"#requirements","title":"Requirements","text":"<p>To access UK Open Banking APIs, you will need to have an appropriate authorisation/registration with the FCA which gives you access to the UK Open Banking directory. To use bank sandboxes, you simply need to register with OBIE to use the UK Open Banking directory sandbox.</p> <p>Open Banking Connector needs to be hosted in your back-end and requires access to a database and configuration. Please see infrastructure requirements for more information.</p>"},{"location":"#philosophy-and-business-model","title":"Philosophy and business model","text":"<p>Open Banking Connector was conceived following difficulties encountered when integrating with different bank APIs. It seemed pointless that everyone should have the burden of individually integrating with each bank - why couldn't we all contribute to a community effort instead?</p> <p>In particular, bank profiles (which capture bank-specific behaviours) were created so that new ones could be added and existing ones updated by the community, perhaps even by the banks themselves.</p> <p>The product is fully free-to-use but we ask customers to fund new features and bank integrations either by direct code contributions (please contact us) or by contracting us (Finnovation Labs) to do the work.</p> <p>Finnovation Labs also offers paid support, training and consultancy services.</p>"},{"location":"#documentation","title":"Documentation","text":"<p>This documentation is published on the docs website based on Markdown source code in the docs directory of the GitHub repo.</p> <p>Please raise a GitHub issue if you experience any problems or have any feedback.</p>"},{"location":"bank-integrations/","title":"Bank Integrations","text":"<p>The table below shows the banks which have been integrated with Open Banking Connector.</p> <p>UK Open Banking uses the Financial-grade API security profile. In this profile, APIs are provided by an OIDC Issuer. In general, a bank will provision an OIDC Issuer per banking brand but sometimes also per mobile app to allow for different auth URLs (which can then redirect to different mobile apps).</p> <p>In Open Banking Connector banks are identified by bank profiles. These are also given below.</p> Bank Group Brand/App (OIDC Issuer) Sandbox? Bank Profile APIs Barclays PersonalWealthBarclaycardBusinessCorporateBarclaycard\u00a0Commercial\u00a0Payments Barclays_PersonalBarclays_WealthBarclays_BarclaycardBarclays_BusinessBarclays_CorporateBarclays_BarclaycardCommercialPayments AISP HSBC FirstDirectUK PersonalUK BusinessUK KineticHSBCnet UK Hsbc_FirstDirectHsbc_UkPersonalHsbc_UkBusinessHsbc_UkKineticHsbc_HsbcNetUk AISP Lloyds SandboxLloyds PersonalLloyds BusinessLloyds CommercialHalifax PersonalBank\u00a0of\u00a0Scotland\u00a0PersonalBank\u00a0of\u00a0Scotland\u00a0BusinessBank\u00a0of\u00a0Scotland\u00a0CommercialMBNA Personal Lloyds_SandboxLloyds_LloydsPersonalLloyds_LloydsBusinessLloyds_LloydsCommericalLloyds_HalifaxPersonalLloyds_BankOfScotlandPersonalLloyds_BankOfScotlandBusinessLloyds_BankOfScotlandCommericalLloyds_MbnaPersonal AISP NatWest NatWest SandboxRBS SandboxNatWestNatWest BanklineNatWest ClearSpendRBSRBS BanklineRBS ClearSpendThe OneNatWest OneVirgin OneUlster Bank NIUlster Bank NI BanklineUlster\u00a0Bank\u00a0NI\u00a0ClearSpendMettle (under test)Coutts (under test) NatWest_NatWestSandboxNatWest_RoyalBankOfScotlandSandboxNatWest_NatWestNatWest_NatWestBanklineNatWest_NatWestClearSpendNatWest_RoyalBankOfScotlandNatWest_RoyalBankOfScotlandBanklineNatWest_RoyalBankOfScotlandClearSpendNatWest_TheOneNatWest_NatWestOneNatWest_VirginOneNatWest_UlsterBankNiNatWest_UlsterBankNiBanklineNatWest_UlsterBankNiClearSpendNatWest_MettleNatWest_Coutts AISP OBIE ModeloModel Bank (2023) (under test) Obie_Modelo  Obie_Model2023 AISP,\u00a0PISP"},{"location":"apis/","title":"APIs","text":""},{"location":"apis/#overview","title":"Overview","text":"<p>Open Banking Connector provides a set of HTTP APIs. Mostly these act as outer APIs providing replacement endpoints for endpoints provided by UK Open Banking APIs. These replacement endpoints wrap calls to UK Open Banking API endpoints as well as extra calls for token acquisition etc. Aside from the Bank Configuration and Auth Context APIs, Open Banking Connector APIs aim to mirror their UK Open Banking equivalents as much as possible.</p> <p>The APIs provided are as follows:</p> API Description Bank Configuration This API provides endpoints for bank setup including replacement endpoints for endpoints provided in the UK Open Banking Dynamic Client Registration API Account and Transaction This API aims to mirror the UK Open Banking Account and Transaction API. Payment Initiation This API aims to mirror the UK Open Banking Payment Initiation API. Variable Recurring Payments This API aims to mirror the UK Open Banking Variable Recurring Payments API. Auth Contexts API This API provides endpoints for handling bank OAuth2 redirects that occur following end-user auth"},{"location":"apis/#security","title":"Security","text":"<p>The Open Banking Connector APIs are internal (i.e. non-internet-accessible) APIs for consumption within your back-end infrastructure. They should definitely not (!) be exposed to the internet in any way. This is very important as these endpoints provide access to Open Banking APIs.</p> <p>The APIs are provided as HTTP rather than HTTPS APIs as customers are expected to configure HTTPS via an outer wrapper (e.g. using Kubernetes or a reverse proxy) to enable easier certificate configuration and to set up features such as MTLS.</p> <p>As internal APIs, they do not require tokens but should obviously be secured as appropriate, e.g. via MTLS, firewalls, AWS security groups etc.</p> <p>Internally, Open Banking Connector acquires and uses tokens to access UK Open Banking APIs. As a security feature, these tokens are not retrievable via the Open Banking Connector APIs. So, for example, when reading (GETing) a consent such as an Account Access Consent, tokens will not be included in the consent payload. To inspect them (in encrypted form), you will need to query the database directly.</p>"},{"location":"apis/account-and-transaction/","title":"Account and Transaction API","text":"<p>The Account and Transaction API provides access to UK Open Banking Account and Transaction API functionality.</p>"},{"location":"apis/account-and-transaction/#openapi-spec","title":"OpenAPI Spec","text":"<p>An OpenAPI spec for the Account and Transaction API showing the endpoints and data types is provided here. This is a static capture of the API at a given release (see grey box at top right of OpenAPI spec for which release).</p> <p>For any running version of Open Banking Connector, the OpenAPI spec for the currently-running software is provided at <code>GET /swagger/index.html</code>.</p>"},{"location":"apis/account-and-transaction/#relationship-to-uk-open-banking-account-and-transaction-api","title":"Relationship to UK Open Banking Account and Transaction API","text":"<p>The UK Open Banking Account and Transaction (AISP) API is defined here.</p> <p>Open Banking Connector provides replacement endpoints for the UK OB AISP endpoints as shown in the following table. The replacement endpoints, where relevant, use data types from UK OB AISP API version v3.1.10. When calling external (bank) APIs, Open Banking Connector performs request/response payload translation for any banks supporting earlier API versions.</p> UK OB AISP endpoint Replacement Open Banking Connector endpoint POST /account-access-consents POST /aisp/account-access-consents GET /account-access-consents/{ConsentId} GET /aisp/account-access-consents/{accountAccessConsentId} DELETE /account-access-consents/{ConsentId} DELETE /aisp/account-access-consents/{accountAccessConsentId} GET /accounts GET /aisp/accounts GET /accounts/{AccountId} GET /aisp/accounts/{externalApiAccountId} GET /balances GET /aisp/balances GET /accounts/{AccountId}/balances GET /aisp/accounts/{externalApiAccountId}/balances GET /direct-debits GET /aisp/direct-debits GET /accounts/{AccountId}/direct-debits GET /aisp/accounts/{externalApiAccountId}/direct-debits GET /party GET /aisp/party GET /accounts/{AccountId}/party GET /aisp/accounts/{externalApiAccountId}/party GET /accounts/{AccountId}/parties GET /aisp/accounts/{externalApiAccountId}/parties GET /standing-orders GET /aisp/standing-orders GET /accounts/{AccountId}/standing-orders GET /aisp/accounts/{externalApiAccountId}/standing-orders GET /transactions GET /aisp/transactions GET /accounts/{AccountId}/transactions GET /aisp/accounts/{externalApiAccountId}/transactions GET /accounts/{AccountId}/statements/{StatementId}/transactions GET /aisp/accounts/{externalApiAccountId}/statements/{externalApiStatementId}/transactions <p>All replacement Open Banking Connector endpoints handle behaviour and spec variations between banks meaning the same API calls can be used regardless of bank. Bank-specific differences are determined by a bank's bank profile.</p> <p>In the UK OB AISP API, resource endpoints such as <code>GET /accounts</code> require a consent-specific bearer token supplied in the <code>Authorization</code> header. Corresponding Open Banking Connector endpoints instead require the <code>x-obc-account-access-consent-id</code> header to be populated with the relevant account access consent ID (<code>Id</code> returned from POST /aisp/account-access-consents).</p> <p>The Open Banking Connector API provides two additional endpoints that are not UK OB replacements: POST /aisp/account-access-consent-auth-contexts and GET /aisp/account-access-consent-auth-contexts/{accountAccessConsentAuthContextId}. These respectively create and read an auth context which is a time-limited session for end-user authentication. Calling POST /aisp/account-access-consent-auth-contexts creates an auth context and returns a URL which can be used for end-user auth.</p>"},{"location":"apis/account-and-transaction/#mappings-to-database-objects","title":"Mappings to database objects","text":"<p>The following endpoints create/read/delete records in the account_access_consent database table:</p> <ul> <li>POST /aisp/account-access-consents</li> <li>GET/aisp/account-access-consents/{accountAccessConsentId}</li> <li>DELETE /aisp/account-access-consents/{accountAccessConsentId}</li> </ul> <p>The following endpoints create/read records of kind <code>AccountAccessConsentAuthContext</code> in the auth_context table (these records are deleted automatically following successful auth):</p> <ul> <li>POST /aisp/account-access-consent-auth-contexts</li> <li>GET /aisp/account-access-consent-auth-contexts/{accountAccessConsentAuthContextId}</li> </ul>"},{"location":"apis/account-and-transaction/#external-bank-api-operations","title":"External (bank) API operations","text":"<p>All replacement Open Banking Connector endpoints included in the table above perform a call to the relevant external (bank) API endpoint listed. Additionally, calls are made to the external API token endpoint as required.</p> <p>In the case of DELETE /aisp/account-access-consents/{accountAccessConsentId}, the header <code>x-obc-include-external-api-operation</code> can be used to avoid deleting an account access consent at the external API (the default behaviour). When <code>x-obc-include-external-api-operation</code> is <code>false</code>, only the local database object will be deleted. </p>"},{"location":"apis/account-and-transaction/openapi/","title":"OpenAPI spec","text":""},{"location":"apis/auth-contexts/","title":"Auth Contexts API","text":"<p>The Auth Contexts API provides endpoints for managing auth contexts.</p>"},{"location":"apis/auth-contexts/#openapi-spec","title":"OpenAPI Spec","text":"<p>An OpenAPI spec for the Auth Contexts API showing the endpoints and data types is provided here. This is a static capture of the API at a given release (see grey box at top right of OpenAPI spec for which release).</p> <p>For any running version of Open Banking Connector, the OpenAPI spec for the currently-running software is provided at <code>GET /swagger/index.html</code>.</p>"},{"location":"apis/auth-contexts/openapi/","title":"OpenAPI spec","text":""},{"location":"apis/bank-configuration/","title":"Bank Configuration API","text":"<p>The Bank Configuration API allows you to create, read, and delete configuration (setup) objects for a bank in Open Banking Connector.</p>"},{"location":"apis/bank-configuration/#openapi-spec","title":"OpenAPI Spec","text":"<p>An OpenAPI spec for the Bank Configuration API showing the endpoints and data types is provided here. This is a static capture of the API at a given release (see grey box at top right of OpenAPI spec for which release).</p> <p>For any running version of Open Banking Connector, the OpenAPI spec for the currently-running software is provided at <code>GET /swagger/index.html</code>.</p>"},{"location":"apis/bank-configuration/#relationship-to-uk-open-banking-dynamic-client-registration-api","title":"Relationship to UK Open Banking Dynamic Client Registration API","text":"<p>The UK Open Banking Dynamic Client Registration (DCR) API is defined here.</p> <p>Open Banking Connector provides replacement endpoints for the UK OB DCR endpoints as shown below. The replacement endpoints, where relevant, use data types from the latest UK OB DCR v3.3 API. When calling external (bank) APIs, Open Banking Connector performs request/response payload translation for any banks supporting earlier API versions.</p> UK OB DCR endpoint Replacement Open Banking Connector endpoint POST /register POST /config/bank-registrations GET /register/{ClientId} GET /config/bank-registrations/{bankRegistrationId} DELETE /register/{ClientId} DELETE /config/bank-registrations/{bankRegistrationId} <p>All the replacement Open Banking Connector endpoints handle behaviour and spec variations between banks meaning the same API calls can be used regardless of bank. Bank-specific differences are determined by a bank's bank profile.</p> <p>There are some further major differences when creating a bank registration/OAuth2 client using POST /config/bank-registrations.</p> <p>Firstly, Open Banking Connector can infer most of the payload to send to the bank during DCR from only a few request properties. This means the creation of a new BankRegistration (OAuth2 client) is usually as simple as: <pre><code>POST /config/bank-registrations HTTP/1.1\n# standard headers omitted\n{\n  \"BankProfile\": \"Obie_Modelo\",\n  \"SoftwareStatementProfileId\": \"All\"\n}\n</code></pre> where only the bank's bank profile and ID of the software statement profile are required. Other optional properties are available but generally not necessary to use. </p> <p>Secondly, Open Banking Connector knows when to \"re-use\" an existing external (bank) API OAuth2 client rather than create a new one meaning the user can happily call <code>POST /config/bank-registrations</code> for each bank they want to use without any further knowledge <sup>1</sup>. This client re-use is completely transparent to the user. It can be overridden using the <code>ForceDynamicClientRegistration</code> property.</p> <p>Finally, Open Banking Connector allows an existing OAuth2 client created externally to be passed in using the <code>ExternalApiObject</code> property. This is useful when DCR is not supported by the bank or an OAuth2 client has been created elsewhere. When <code>ExternalApiObject</code> is non-null, DCR is not performed.</p>"},{"location":"apis/bank-configuration/#mappings-to-database-objects","title":"Mappings to database objects","text":"<p>A successful call to <code>POST /config/bank-registrations</code> always creates a record in the database <code>bank_registration</code> table even when DCR is not performed (i.e. an existing client has been supplied or re-used).</p> <p>Likewise, GET /config/bank-registrations/{bankRegistrationId} and DELETE /config/bank-registrations/{bankRegistrationId} can be used to read and delete database <code>bank_registration</code> records. </p>"},{"location":"apis/bank-configuration/#external-bank-api-operations","title":"External (bank) API operations","text":"<p>When <code>POST /config/bank-registrations</code> causes DCR to be performed, a call will be made to the external (bank) API <code>POST /register</code> endpoint and the property <code>ExternalApiResponse</code> will be included in the response. Otherwise just the local database object will be returned.</p> <p>Where supported and specified by the bank profile (or forced via header <code>x-obc-include-external-api-operation</code>), GET /config/bank-registrations/{bankRegistrationId} will perform a call to the external (bank) API <code>GET /register</code> endpoint and the property <code>ExternalApiResponse</code> will be included in the response. Otherwise just the local database object will be returned.</p> <p>Where supported and specified by the bank profile (or forced via header <code>x-obc-include-external-api-operation</code>), DELETE /config/bank-registrations/{bankRegistrationId} will perform a call to the external (bank) API <code>DELETE /register/{ClientId}</code> endpoint. Otherwise just the local database object will be deleted.</p> <p>Note that only a few banks support <code>GET /register/{ClientId}</code> and <code>DELETE /register/{ClientId}</code> and so in most cases GET /config/bank-registrations/{bankRegistrationId} and DELETE /config/bank-registrations/{bankRegistrationId} will not result in external (bank) API calls.</p> <ol> <li> <p>Why is this re-use necessary or desirable? Some bank groups (e.g. <code>NatWest</code>) expect/require the same OAuth2 client to re-used between sets of banks (e.g. <code>NatWest_RoyalBankOfScotland</code> and <code>NatWest_VirginOne</code>). Also performing DCR twice for the same bank might, depending on bank behaviour, result in re-generating the previous OAuth2 client (with same ID). For at least one bank, though, using the same client for both AISP and PISP is not allowed. Open Banking Connector has an internal concept of bank registration groups. These are essentially rules which determine when OAuth2 clients can be re-used (shared) by default. These are designed to ensure <code>POST /config/bank-registrations</code> can be called safely for all banks and only creates new OAuth2 clients where necessary.\u00a0\u21a9</p> </li> </ol>"},{"location":"apis/bank-configuration/openapi/","title":"OpenAPI spec","text":""},{"location":"apis/payment-initiation/","title":"Payment Initiation API","text":"<p>The Payment Initiation API provides access to UK Open Banking Payment Initiation API functionality.</p>"},{"location":"apis/payment-initiation/#openapi-spec","title":"OpenAPI Spec","text":"<p>An OpenAPI spec for the Payment Initiation API showing the endpoints and data types is provided here. This is a static capture of the API at a given release (see grey box at top right of OpenAPI spec for which release).</p> <p>For any running version of Open Banking Connector, the OpenAPI spec for the currently-running software is provided at <code>GET /swagger/index.html</code>.</p>"},{"location":"apis/payment-initiation/#relationship-to-uk-open-banking-payment-initiation-api","title":"Relationship to UK Open Banking Payment Initiation API","text":"<p>The UK Open Banking Payment Initiation (PISP) API is defined here.</p> <p>Open Banking Connector provides replacement endpoints for the UK OB PISP endpoints as shown in the following table. The replacement endpoints, where relevant, use data types from UK OB PISP API version v3.1.6. When calling external (bank) APIs, Open Banking Connector performs request/response payload translation for any banks supporting earlier API versions.</p> UK OB PISP endpoint Replacement Open Banking Connector endpoint POST /domestic-payment-consents POST /pisp/domestic-payment-consents GET /domestic-payment-consents/{ConsentId} GET /pisp/domestic-payment-consents/{domesticPaymentConsentId} POST /domestic-payments POST /pisp/domestic-payments GET /domestic-payments/{DomesticPaymentId} GET /pisp/domestic-payments/{externalApiId} <p>All replacement Open Banking Connector endpoints handle behaviour and spec variations between banks meaning the same API calls can be used regardless of bank. Bank-specific differences are determined by a bank's bank profile.</p> <p>In the UK OB PISP API, some resource endpoints such as <code>POST /domestic-payments</code> require a consent-specific bearer token supplied in the <code>Authorization</code> header. Corresponding Open Banking Connector endpoints instead require the <code>x-obc-domestic-payment-consent-id</code> header to be populated with the relevant domestic payment consent ID (<code>Id</code> returned from POST /pisp/domestic-payment-consents).</p> <p>The Open Banking Connector API provides two additional endpoints that are not UK OB replacements: POST /pisp/domestic-payment-consent-auth-contexts and GET /pisp/domestic-payment-consent-auth-contexts/{domesticPaymentConsentAuthContextId}. These respectively create and read an auth context which is a time-limited session for end-user authentication. Calling POST /pisp/domestic-payment-consent-auth-contexts creates an auth context and returns a URL which can be used for end-user auth.</p>"},{"location":"apis/payment-initiation/#mappings-to-database-objects","title":"Mappings to database objects","text":"<p>The following endpoints create/read records in the domestic_payment_consent database table:</p> <ul> <li>POST /pisp/domestic-payment-consents</li> <li>GET /pisp/domestic-payment-consents/{domesticPaymentConsentId}</li> </ul> <p>The following endpoints create/read records of kind <code>DomesticPaymentConsentAuthContext</code> in the auth_context table (these records are deleted automatically following successful auth):</p> <ul> <li>POST /pisp/domestic-payment-consent-auth-contexts</li> <li>GET /pisp/domestic-payment-consent-auth-contexts/{domesticPaymentConsentAuthContextId}</li> </ul>"},{"location":"apis/payment-initiation/#external-bank-api-operations","title":"External (bank) API operations","text":"<p>All replacement Open Banking Connector endpoints included in the table above perform a call to the relevant external (bank) API endpoint listed. Additionally, calls are made to the external API token endpoint as required.</p>"},{"location":"apis/payment-initiation/openapi/","title":"OpenAPI spec","text":""},{"location":"apis/variable-recurring-payments/","title":"Variable Recurring Payments API","text":"<p>The Variable Recurring Payments API provides access to UK Open Banking Variable Recurring Payments API functionality.</p>"},{"location":"apis/variable-recurring-payments/#openapi-spec","title":"OpenAPI Spec","text":"<p>An OpenAPI spec for the Variable Recurring Payments API showing the endpoints and data types is provided here. This is a static capture of the API at a given release (see grey box at top right of OpenAPI spec for which release).</p> <p>For any running version of Open Banking Connector, the OpenAPI spec for the currently-running software is provided at <code>GET /swagger/index.html</code>.</p>"},{"location":"apis/variable-recurring-payments/#relationship-to-uk-open-banking-variable-recurring-payments-api","title":"Relationship to UK Open Banking Variable Recurring Payments API","text":"<p>(Coming soon)</p>"},{"location":"apis/variable-recurring-payments/#mappings-to-database-objects","title":"Mappings to database objects","text":"<p>(Coming soon)</p>"},{"location":"apis/variable-recurring-payments/#external-bank-api-operations","title":"External (bank) API operations","text":"<p>(Coming soon)</p>"},{"location":"apis/variable-recurring-payments/openapi/","title":"OpenAPI spec","text":""},{"location":"configuration/","title":"Configuration &amp; secrets","text":"<p>Configuration and secrets are read-only settings that customise the behaviour of Open Banking Connector. This is in contrast to database access which is read-write.</p> <p>Secrets provide sensitive configuration but, from Open Banking Connector's perspective, configuration and secrets are unified in that any setting can be assigned a value by any configuration provider. (This does not mean the two should be stored together or supplied from the same source though - see secrets and security below).</p> <p>Here we give an overview of configuration in Open Banking Connector.</p>"},{"location":"configuration/#structure","title":"Structure","text":"<p>Configuration consists of settings which can be assigned values.</p> <p>These settings are organised by area into settings groups.</p> <p>Settings have a hierarchical naming structure where the first \"level\" is always OpenBankingConnector (essentially a namespace) and subsequent levels are separated by colons (:).</p> <p>Values are always representable as strings (although in JSON files, where applicable and optionally, they may be represented in natural form as numbers and booleans where applicable).</p> <p>Below is an example of a setting and value that configures the Open Banking Connector database provider to be <code>\"Sqlite\"</code>:</p> Setting Value OpenBankingConnector:Database:Provider <code>\"Sqlite\"</code>"},{"location":"configuration/#settings-groups","title":"Settings groups","text":"<p>Open Banking Connector configuration settings are collected into groups which are described on their own pages:</p> <ul> <li>database settings configure the database used by Open Banking Connector</li> <li>software statement profiles settings configure software statement profiles used by Open Banking Connector</li> <li>transport certificate profiles settings configure transport certificate profiles used by Open Banking Connector</li> <li>signing certificate profiles settings configure signing certificate profiles used by Open Banking Connector</li> <li>encryption keys settings configure encryption keys used by Open Banking Connector</li> <li>configuration sources settings configure configuration sources used by Open Banking Connector</li> <li>open telemetry settings configure Open Telemetry settings used by Open Banking Connector</li> </ul>"},{"location":"configuration/#sources","title":"Sources","text":"<p>Open Banking Connector is written in .NET and by default uses ASP.NET Core default application configuration sources to collect configuration from a number of configuration providers in priority order.</p> <p>These include the command-line and environment variable providers as highest-priority providers.</p> <p>Configuration sources can be customised and added using configuration sources settings.</p>"},{"location":"configuration/#secrets-and-security","title":"Secrets and security","text":"<p>Some settings values are very sensitive, for example keys, and should be carefully and securely stored and managed.</p> <p>It is recommended to provide sensitive configuration (secrets) and standard configuration from different sources and not to store them together.</p> <p>For example, standard configuration could be supplied via environment variables and secrets from a cloud secrets provider.</p> <p>Even if environment variables are the vehicle for providing both (to decouple configuration and application), the secrets environment variables could e.g. be dynamically produced during application/pod startup and not stored with standard configuration.</p>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<p>When supplying configuration via environment variables, you should use double underscores (__) in place of colons (:) in settings names. So, for instance, the setting OpenBankingConnector:Database:Provider would be configured using environment variable <code>OpenBankingConnector__Database__Provider</code>. This is a .NET convention and explained here.</p>"},{"location":"configuration/configuration-sources-settings/","title":"Configuration sources settings","text":"<p>Configuration sources are an ASP.NET Core concept and are used in Open Banking Connector to provide configuration settings including secrets.</p> <p>Configuration sources settings are settings which adjust configuration sources used from the defaults given here. Any new configuration sources added will be added with lower priority than the default environment variable and command line sources.</p> <p>These settings should only be modified from a default configuration source, e.g. environemnt variables, so that they can be picked up. For example, specifying use of the AWS SSM parameter source via an AWS SSM parameter will not work.</p>"},{"location":"configuration/configuration-sources-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:ConfigurationSources:UseUserSecrets {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"false\"</code> (development environment) <p> <code>\"true\"</code> (otherwise) User secrets are a ASP.NET Core configuration source intended for use in development (see here). This setting allows user secrets to be explicitly included or excluded as desired. OpenBankingConnector:ConfigurationSources:AwsSsmParameterPrefix string <code>\"\"</code> A non-empty value specifies that AWS SSM parameters with the specified prefix will be used as a configuration source in Open Banking Connector. The specified prefix functions as a namespace, so for example an AWS SSM parameter <code>/&lt;specifiedPrefix&gt;/OpenBankingConnector/Database/EnsureDatabaseCreated</code> will map to Open Banking Connector setting <code>OpenBankingConnector:Database:EnsureDatabaseCreated</code>. When this configuration source is used, please ensure Open Banking Connector is run in an envrionment with an AWS IAM role/user which contains a suitable permissions policy<sup>1</sup>. <ol> <li> <p>Exmple AWS permission policy: <pre><code>{\n\"Version\": \"2012-10-17\",\n\"Statement\": [\n{\n\"Sid\": \"SSMPermissionStatement\",\n\"Effect\": \"Allow\",\n\"Action\": \"ssm:GetParametersByPath\",\n\"Resource\": \"arn:aws:ssm:eu-west-2:&lt;awsAccountId&gt;:parameter/&lt;specifiedPrefix&gt;/*\"\n}\n]\n}\n</code></pre> \u21a9</p> </li> </ol>"},{"location":"configuration/database-settings/","title":"Database settings","text":"<p>Database settings are used to configure the database used by Open Banking Connector to read and write data.</p> <p>In non-development environments (the default), you will at least need to at least provide a connection string setting for the configured database provider.</p>"},{"location":"configuration/database-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:Database:Provider {<code>\"Sqlite\"</code>, <code>\"PostgreSql\"</code>} <code>\"PostgreSql\"</code> Determines which database provider Open Banking Connector uses. OpenBankingConnector:Database:ConnectionStrings:{Provider} <p> where Provider \u2208 {Sqlite, PostgreSql} </p> string <code>\"Data Source=./sqliteTestDb.db\"</code> (development environment and Provider = <code>\"Sqlite\"</code>) <p> <code>\"Host=localhost;Database=test;</code><code>Username=postgres\"</code> (development environment and Provider = <code>\"PostgreSql\"</code>) <p> - (otherwise) Connection strings for each database provider. Open Banking Connector only reads the one for the provider specified by OpenBankingConnector:Database:Provider. The BankTests project, however, may use multiple connection strings to test with multiple databases. A list of connection string parameters for provider <code>PostgreSql</code> is given here. OpenBankingConnector:Database:EnsureDatabaseCreated {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"false\"</code> At application start-up, ensure database is created if does not exist. OpenBankingConnector:Database:EnsureDatabaseMigrated {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"true\"</code> At application start-up, apply pending migrations. Only supported for database providers with migration support (i.e. only PostgreSql at this time)."},{"location":"configuration/encryption-keys-settings/","title":"Encryption keys settings","text":"<p>Encryption keys are used to encrypt sensitive information such as bank access and refresh tokens stored in the database at application level as part of defence-in-depth. It is assumed and recommended that database at-rest encryption is also used.</p> <p>(Note that bank endpoints accepting tokens also authenticate the client with MTLS as a further level of protection so unencrypted bank tokens are not usable in isolation.)</p> <p>Encryption is performed using the in-the-box .NET implementation of AES-256-GCM and keys should be 256 bits. Note that use of unique nonces is guaranteed at database level by the unique nonce field in the database encrypted_object table. Please do not hard-delete records in this table whose key_id field matches an encryption key still in use since it is very important for AES-GCM that nonces are never re-used for the same encryption key.</p> <p>Multiple encryption keys can be provided each with its own ID. This allows decryption of objects encrypted with previously-used keys. New objects will be encrypted with the key specified by OpenBankingConnector:Keys:CurrentEncryptionKeyId. Keys are specified as a base64-encoded string.</p> <p>It is up to the user to generate their own keys, but for example purposes the Kubernetes docs suggest that on Linux a base64-encoded key can be generated via the command <pre><code>head -c 32 /dev/urandom | base64\n</code></pre></p> <p>No encryption keys are configured by default and you will require at least one in order to use Open Banking Connector unless encryption is disabled. To create one, simply decide upon an ID and configure minimally the settings lacking defaults below.</p> <p>In the future we plan to support automated rotation of encryption keys which will automate re-encryption of objects and hard-deletion of object records corresponding to old keys.</p>"},{"location":"configuration/encryption-keys-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:Keys:CurrentEncryptionKeyId string - Encryption key to use for encrypting new objects. Specified by key ID. OpenBankingConnector:Keys:Encryption:{Id}:Value <p> where string Id is user-defined encryption key ID </p> string - Encryption key (256-bit) used for symmetric encryption (AES-256-GCM) of sensitive data in database such as bank tokens. Specified as a base64-encoded string. See above for example of how to generate. OpenBankingConnector:Keys:DisableEncryption {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"false\"</code> Disable encryption of new objects (not recommended)."},{"location":"configuration/open-telemetry-settings/","title":"Open Telemetry settings","text":"<p>Open Telemetry settings configure support for Open Telemetry in Open Banking Connector.</p> <p>Open Telemetry is a system for collecting logging, tracing and metrics output from an application (service) like Open Banking Connector. Open Banking Connector support for each of these is indicated below.</p> <p>The service name used by Open Banking Connector for Open Telemetry can be customised using the setting <code>OpenBankingConnector:OpenTelemetry:ServiceName</code>. The service version used for Open Telemetry will be set to the product version of Open Banking Connector.</p>"},{"location":"configuration/open-telemetry-settings/#support-for-open-telemetry-logging","title":"Support for Open Telemetry logging","text":"<p>By default, Open Telemetry trace and span IDs are included with logs. To propagate trace IDs from a service making requests to Open Banking Connector, please include the <code>traceparent</code> header as described here in requests.</p>"},{"location":"configuration/open-telemetry-settings/#support-for-open-telemetry-tracing","title":"Support for Open Telemetry tracing","text":"<p>Support for Open Telemetry tracing can be enabled by setting <code>OpenBankingConnector:OpenTelemetry:Tracing:UseConsoleExporter</code> to true (for console output) or specifying an exporter URL in <code>OpenBankingConnector:OpenTelemetry:Tracing:OtlpExporterUrl</code>. You can control the level of output by means of <code>OpenBankingConnector:OpenTelemetry:Tracing:ProviderFilter</code>.</p>"},{"location":"configuration/open-telemetry-settings/#support-for-open-telemetry-metrics","title":"Support for Open Telemetry metrics","text":"<p>This is not enabled yet.</p>"},{"location":"configuration/open-telemetry-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:OpenTelemetry:ServiceName string <code>\"FinnovationLabs.OpenBanking.Connector\"</code> Use to customise the service name used with Open Telemetry OpenBankingConnector:OpenTelemetry:Tracing:UseConsoleExporter bool <code>false</code> Add console exporter to tracing. Will send tracing output to the console. OpenBankingConnector:OpenTelemetry:Tracing:OtlpExporterUrl string <code>\"\"</code> When non-empty, add OTLP (Open Telemetry Protocol) exporter to tracing with target URL as specified. OpenBankingConnector:OpenTelemetry:Tracing:ProviderFilter int <code>3</code> (AspNetCore and HttpClient only) Use to control tracing providers. Provide sum of desired providers where AspNetCore (top-level) = 1, HttpClient (bank requests) = 2, EFCore (database ORM) = 4."},{"location":"configuration/signing-certificate-profiles-settings/","title":"Signing certificate profiles settings","text":"<p>Signing certificate profiles settings are used to configure signing certificate profiles used by Open Banking Connector.</p> <p>A signing certificate profile is a group of settings comprising information related to a signing certificate. It is identified by a user-defined profile ID. It is referenced by one or more software statement profiles.</p> <p>Signing certificates and associated keys are used to sign and validate JWTs sent to banks.</p> <p>No signing certificate profiles are configured by default and you will require at least one in order to create a bank registration.</p>"},{"location":"configuration/signing-certificate-profiles-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:SigningCertificateProfiles:{Id}:Active <p> where string Id is user-defined profile ID </p> {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"true\"</code> Whether profile is active or inactive (ignored by Open Banking Connector). This allows profiles to be \"switched on and off\" for testing etc. OpenBankingConnector:SigningCertificateProfiles:{Id}:SigningCertificateType <p> where string Id is user-defined profile ID </p> {<code>\"OBLegacy\"</code>, <code>\"OBSeal\"</code>} <code>\"OBSeal\"</code> Type of UK Open Banking Directory certificate used. OpenBankingConnector:SigningCertificateProfiles:{Id}:AssociatedKeyId <p> where string Id is user-defined profile ID </p> string - Signing Key ID (from UK Open Banking Directory) as string. This is not the same as the user-defined profile ID for this profile. OpenBankingConnector:SigningCertificateProfiles:{Id}:AssociatedKey <p> where string Id is user-defined profile ID </p> string - Signing key (PKCS #8) as \"stringified\" PEM file with escaped newline characters (\"<code>\\n</code>\") and PRIVATE KEY label.             Example: <code>\"-----BEGIN PRIVATE KEY-----\\nABC\\n-----END PRIVATE KEY-----\\n\"</code>."},{"location":"configuration/software-statement-profiles-settings/","title":"Software statement profiles settings","text":"<p>Software statement profiles settings are used to configure software statement profiles for use by Open Banking Connector.</p> <p>In UK Open Banking, a software statement identifies a third-party provider (TPP) that can create bank registrations (OAuth2 clients) with banks and can be seen as a kind of \"passport\". A TPP can create multiple software statements and this is fully supported by Open Banking Connector.</p> <p>You should create the software statements you need in the UK Open Banking Directory. From there, you can also generate a corresponding software statement assertion (SSA) for each. Each SSA can then be the basis of one or more software statement profiles in Open Banking Connector.</p> <p>A software statement profile is a group of settings comprising</p> <ol> <li>a software statement assertion (SSA)</li> <li> <p>associated information which will be used for bank registrations that reference the software statement profile:</p> <ul> <li>a transport certificate profile specifying a transport key/certificate</li> <li>a signing certificate profile which specifying a signing key/certificate</li> <li>a default redirect URL</li> </ul> </li> </ol> <p>Transport certificate profiles and signing certificate profiles can be re-used between software statement profiles, i.e. referenced by more than one software statement profile.</p> <p>When creating a bank registration (OAuth2 client), a software statement profile is specified which configures the associated SSA, transport key-pair, signing key, etc.</p> <p>No software statement profiles are configured by default and you will require at least one in order to create a bank registration. To create a software statement profile, simply decide upon an ID and configure minimally the settings lacking defaults below.</p> <p>As your needs evolve you can create multiple software statement profiles to allow use of multiple SSAs and certs in different combinations etc.</p> <p>Software statement profiles are validated on application start-up so please be alert to warning and error messages related to these.</p>"},{"location":"configuration/software-statement-profiles-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:SoftwareStatementProfiles:{Id}:Active <p> where string Id is user-defined profile ID </p> {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"true\"</code> Whether profile is active or inactive (ignored by Open Banking Connector). This allows profiles to be \"switched on and off\" for testing etc. OpenBankingConnector:SoftwareStatementProfiles:{Id}:SoftwareStatement <p> where string Id is user-defined profile ID </p> string - Software statement assertion (SSA) as string, i.e. \"FirstPart.SecondPart.ThirdPart\". OpenBankingConnector:SoftwareStatementProfiles:{Id}:TransportCertificateProfileId <p> where string Id is user-defined profile ID </p> string - ID of transport certificate profile to use for mutual TLS with this software statement profile. OpenBankingConnector:SoftwareStatementProfiles:{Id}:SigningCertificateProfileId <p> where string Id is user-defined profile ID </p> string - ID of signing certificate profile to use for signing JWTs etc with this software statement profile. OpenBankingConnector:SoftwareStatementProfiles:{Id}:DefaultFragmentRedirectUrl <p> where string Id is user-defined profile ID </p> string - Default redirect URL for consent authorisations when OAuth2 <code>response_mode</code> = <code>fragment</code>."},{"location":"configuration/transport-certificate-profiles-settings/","title":"Transport certificate profiles settings","text":"<p>Transport certificate profiles settings are used to configure transport certificate profiles used by Open Banking Connector.</p> <p>A transport certificate profile is a group of settings comprising a transport certificate, associated key, and other related information. It is identified by a user-defined profile ID. It is referenced by one or more software statement profiles.</p> <p>Transport certificates are used for mutual TLS when communicating with banks.</p> <p>No transport certificate profiles are configured by default and you will require at least one in order to create a bank registration.</p>"},{"location":"configuration/transport-certificate-profiles-settings/#settings","title":"Settings","text":"Name Valid Values Default Value(s) Description OpenBankingConnector:TransportCertificateProfiles:{Id}:Active <p> where string Id is user-defined profile ID </p> {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"true\"</code> Whether profile is active or inactive (ignored by Open Banking Connector). This allows profiles to be \"switched on and off\" for testing etc. OpenBankingConnector:TransportCertificateProfiles:{Id}:TransportCertificateType <p> where string Id is user-defined profile ID </p> {<code>\"OB</code><code>Legacy\"</code>, <code>\"OBWac\"</code>} <code>\"OBWac\"</code> Type of UK Open Banking Directory certificate used. OpenBankingConnector:TransportCertificateProfiles:{Id}:DisableTlsCertificateVerification <p> where string Id is user-defined profile ID </p> {<code>\"true\"</code>, <code>\"false\"</code>} <code>\"false\"</code> Disable verification of external bank TLS certificates when using mutual TLS with this certificate profile. Not intended for production use but sometimes helpful for diagnosing issues with bank sandboxes (e.g. if they use self-signed certificates). OpenBankingConnector:TransportCertificateProfiles:{Id}:AssociatedKey <p> where string Id is user-defined profile ID </p> string - Transport key (PKCS #8) as \"stringified\" PEM file with escaped newline characters (<code>\"\\n\"</code>) and PRIVATE KEY label.             Example: <code>\"-----BEGIN PRIVATE KEY-----\\nABC\\n-----END PRIVATE KEY-----\\n\"</code>. OpenBankingConnector:TransportCertificateProfiles:{Id}:Certificate <p> where string Id is user-defined profile ID </p> string - Transport certificate (X.509) as \"stringified\" PEM file with escaped newline characters (<code>\"\\n\"</code>) and CERTIFICATE label.             Example: <code>\"-----BEGIN CERTIFICATE-----\\nABC\\n-----END CERTIFICATE-----\\n\"</code>."},{"location":"contributor-info/","title":"Contributor info","text":"<p>Open Banking Connector is an open-source project and welcomes contributions. Please contact us for more information about contributing to this project.</p> <p>See the following sections for contributor guidance on:</p> <ul> <li>documentation</li> </ul>"},{"location":"contributor-info/#environment-selection","title":"Environment selection","text":"<p>Open Banking Connector can be run using different environments such as development, staging and production. In fact, its behaviour is only actually sensitive to whether it is run in the development environment.</p> <p>By default, Open Banking Connector uses the production environment.</p> <p>In the development environment, logging, error handling and configuration defaults etc are modified to suit the needs of developing and testing Open Banking Connector. The development environment should not be used in production.</p> <p>Environment selection is not configured by Open Banking Connector settings but normally via the Microsoft <code>DOTNET_ENVIRONMENT</code> or <code>ASPNETCORE_ENVIRONMENT</code> environment variables.</p> <p>Here is an example of how to run the web app container using environment variables to (a) use the development environment and (b) set the DB provider to <code>\"Sqlite\"</code>:</p>"},{"location":"contributor-info/dev-environment/install-ob-root-cert/","title":"Install Open Banking UK root certificate","text":"<p>When running Open Banking Connector as a .NET application from source code, an Open Banking UK root certificate needs to be installed to check remote certs from banks when creating TLS connections to bank sandboxes.</p>"},{"location":"contributor-info/dev-environment/install-ob-root-cert/#obtain-the-root-certificate","title":"Obtain the root certificate","text":"<p>The UK Open Baking Sandbox root certificate can be obtained here.</p> <p>Currently only the Open Banking UK root certificate (and not the issuing certificate) needs to be installed.</p>"},{"location":"contributor-info/dev-environment/install-ob-root-cert/#install-the-root-certificate","title":"Install the root certificate","text":"<p>On Windows, open the certificate manager (certlm.msc) and right-click \"Trusted Root Certification Authorities / Certificates\" and choose to import the certificate.</p> <p>On macOS (Big Sur), double-click the cert to add to the System Keychain and right-click to enable \"Always Trust\".</p>"},{"location":"contributor-info/dev-environment/use-secret-manager/","title":"Use Microsoft's secret manager","text":"<p>When running Open Banking Connector as a .NET application from source code, and when in the development environment, Microsoft's secret manager can be used to provide configuration/secrets.</p> <p>To use the secret manager, you will need a <code>secrets.json</code> file in the appropriate directory (if you do not have one already). The Microsoft documentation here gives the path for this directory. Please note that the UserSecretsId for the app is <code>aa921213-9461-4f9e-8fec-153624ec67ad</code> as given in the web app <code>.csproj</code> file.</p> <p>You can then add key-value pairs to the <code>secrets.json</code> file to supply configuration to Open Banking Connector.</p> <p>Here is an example of what such a file might look like after configuring a software statement profile, transport certificate profile and signing certificate profile:</p> <pre><code>{\n\"OpenBankingConnector:TransportCertificateProfiles:New1:Certificate\": \"-----BEGIN CERTIFICATE-----\\nabc\\n-----END CERTIFICATE-----\\n\",\n\"OpenBankingConnector:TransportCertificateProfiles:New1:AssociatedKey\": \"-----BEGIN PRIVATE KEY-----\\nabc\\n-----END PRIVATE KEY-----\\n\",\n\"OpenBankingConnector:SoftwareStatementProfiles:All:TransportCertificateProfileId\": \"New1\",\n\"OpenBankingConnector:SoftwareStatementProfiles:All:SoftwareStatement\": \"a.b.c\",\n\"OpenBankingConnector:SoftwareStatementProfiles:All:SigningCertificateProfileId\": \"New2\",\n\"OpenBankingConnector:SoftwareStatementProfiles:All:DefaultFragmentRedirectUrl\": \"https://example.com/auth/fragment-redirect\",\n\"OpenBankingConnector:SigningCertificateProfiles:New2:AssociatedKeyId\": \"abc\",\n\"OpenBankingConnector:SigningCertificateProfiles:New2:AssociatedKey\": \"-----BEGIN PRIVATE KEY-----\\nabc\\n-----END PRIVATE KEY-----\\n\"\n}\n</code></pre> <p>Important: Some settings values are very sensitive, for example keys, and should be carefully and securely stored and managed.  They should never be stored in-repo, for example in additional or modified <code>appsettings.json</code> files, due to the risk of disclosure. The secret manager is designed to store secrets out-of-repo during code development and testing where other configuration providers may not be available.</p>"},{"location":"contributor-info/documentation/","title":"Documentation","text":"<p>This section provides contributor information both on creating documentation and publishing it to the docs website.  </p> <p>Documentation is written in Markdown and stored in the repo <code>./docs</code> folder.</p> <p>The documentation is available publicly:</p> <ul> <li>on the GitHub repo (reflects latest commits)</li> <li>on the docs website (reflects capture of documentation most recently pushed to <code>gh_pages</code> branch)</li> </ul> <p>We here provide guidance for</p> <ul> <li>updating documentation in the <code>./docs</code> folder</li> <li>deploying documentation from the <code>./docs</code> folder to the docs website.  </li> </ul>"},{"location":"contributor-info/documentation/deploy-documentation/","title":"Deploy documentation","text":"<p>Here are the steps required to:</p> <ul> <li> <p>prepare for deployment </p> </li> <li> <p>deploy documentation to website</p> </li> </ul>"},{"location":"contributor-info/documentation/deploy-documentation/#pre-requisites","title":"Pre-requisites","text":"<p>To publish documentation to the website, you will need to have permission to push to the <code>gh-pages</code> branch of the repo.</p> <p>You will require Python 3 and Material for MkDocs (mkdocs-material).</p> <p>Assuming you have installed Python, you can install Material for MkDocs as follows:</p> <pre><code>pip install mkdocs-material\npip install mkdocs-git-revision-date-localized-plugin \npip install mkdocs-render-swagger-plugin\n</code></pre>"},{"location":"contributor-info/documentation/deploy-documentation/#prepare-for-deployment","title":"Prepare for deployment","text":""},{"location":"contributor-info/documentation/deploy-documentation/#preview-website","title":"Preview website","text":"<p>To deploy the website locally for inspection and testing, please <code>cd</code> to the repo root and run the following command: <pre><code>mkdocs serve\n</code></pre> This will return the URL you can use to preview the website. Commit and push any corrections or updates required.</p>"},{"location":"contributor-info/documentation/deploy-documentation/#deploy-website","title":"Deploy website","text":"<p>Assuming you have permissions to push to the repo <code>gh-pages</code> branch, you can update the public website on GitHub Pages using: <pre><code>mkdocs gh-deploy -m \"Message\" -r publicRemote --ignore-version # adjust commit message and remote as required \n</code></pre></p> <p>N.B. The <code>--ignore-version</code> flag is used to solve the problem of Mkdocs confusing the tag version with the Mkdocs version which stops the website from being deployed.</p>"},{"location":"contributor-info/documentation/update-documentation/","title":"Update documentation","text":"<p>To update documentation:</p> <ul> <li>edit files in the repo <code>./docs</code> folder</li> <li>update the <code>nav</code> section in the repo <code>./mkdocs.yml</code> file to specify sections and links.</li> </ul> <p>In the docs, please ensure links to other repo files are relative links. For example: <pre><code>[Page](./page.md)\n</code></pre></p> <p>Once docs are updated, you can deploy the documentation.</p>"},{"location":"get-started/","title":"Get started","text":"<p>In this section, we describe how to get started with Open Banking Connector.</p> <p>We first show how to get Open Banking Connector up and running, then demonstrate how to access bank APIs using Open Banking Connector.</p>"},{"location":"get-started/#get-open-banking-connector-up-and-running","title":"Get Open Banking Connector up and running","text":"<p>To get Open Banking Connector up and running, you will need to do the following:</p> <ol> <li>set up configuration and secrets</li> <li>pull and run the Open Banking Connector Docker image</li> </ol>"},{"location":"get-started/#use-open-banking-connector-to-access-bank-apis","title":"Use Open Banking Connector to access bank APIs","text":"<p>We here walk through the basics of common Open Banking operations and provide examples using the OBIE Modelo model bank.</p>"},{"location":"get-started/#create-a-bank-registration","title":"Create a bank registration","text":"<p>The first thing to do with Open Banking Connector is to create a relationship with a bank by creating a bank registration.</p>"},{"location":"get-started/#use-an-account-access-consent-to-access-account-data","title":"Use an account access consent to access account data","text":"<p>With a bank registration you can create and authorise an account access consent.</p> <p>Once an account access consent is authorised, you can use it to get account data.</p>"},{"location":"get-started/create-and-authorise-account-access-consent/","title":"Create and authorise an account access consent","text":"<p>To access end-user account data, you must first create and authorise an account access consent.</p> <p>For demonstration purposes, here we will use manual browser end-user auth (i.e. cut and paste auth URL into browser) which is suitable for sandboxes such as the OBIE Modelo model bank.</p> <p>Supporting end-user auth with real banks requires creating a suitable app - please see here for more info.</p>"},{"location":"get-started/create-and-authorise-account-access-consent/#create-an-account-access-consent","title":"Create an account access consent","text":"<p>An account access consent specifies the permissions that you seek the end-user to authorise. Since the available permissions differ between banks, Open Banking Connector allows you to use the template \"MaximumPermissions\" as an alternative to listing them explicitly.</p> <p>This template alongside the bank registration ID can be used to create an account access consent.</p> <p>Upon creation, Open Banking Connector will provide you with an ID for the account access consent which you can then use to create an auth context (auth session) and, following auth, get account data.</p>"},{"location":"get-started/create-and-authorise-account-access-consent/#example-with-postman-and-obie-modelo-model-bank","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/create-and-authorise-account-access-consent/#create-an-auth-context","title":"Create an auth context","text":"<p>Create an auth context (auth session) for your account access consent to begin end-user auth.</p> <p>Upon creation, Open Banking Connector will provide you with an auth URL for end-user auth.</p>"},{"location":"get-started/create-and-authorise-account-access-consent/#example-with-postman-and-obie-modelo-model-bank_1","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/create-and-authorise-account-access-consent/#perform-end-user-auth","title":"Perform end-user auth","text":"<p>To perform manual end-user auth (suitable for sandboxes), copy the auth URL into a browser and go through authentication.</p> <p>When this is complete you will be redirected back to your redirect URL, which by default will be the default fragment redirect URL from the software statement profile used when creating the consent's bank registration. Even if no web page exists at this URL, you can still copy the URL fragment from your browser to obtain the bank redirect data. </p>"},{"location":"get-started/create-and-authorise-account-access-consent/#supply-redirect-data-to-open-banking-connector","title":"Supply redirect data to Open Banking Connector","text":"<p>To complete end-user auth, pass on to Open Banking Connector the bank redirect data supplied by the bank as a fragment appended to the redirect URL. This needs to be done within 10 minutes of auth context creation or you will need to create a new auth context and attempt auth again.</p> <p>Upon receipt and successful validation of bank redirect data, Open Banking Connector will obtain tokens for the consent in preparation for requests to get account data.</p>"},{"location":"get-started/create-and-authorise-account-access-consent/#example-with-postman-and-obie-modelo-model-bank_2","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/create-bank-registration/","title":"Create a bank registration","text":"<p>To access Open Banking APIs provided by a bank, you need to create a bank registration (OAuth2 client) which establishes a relationship between you and the bank.</p> <p>To do this, first identify the bank profile for the bank you wish to connect to. Bank profiles are listed in the bank integrations table.</p> <p>Each bank registration requires the ID of a software statement profile (includes an SSA which identifies the third-party provider (TPP) to the bank) which has been set up in configuration.</p> <p>You can then use the bank profile and software statement profile ID to create a new bank registration.</p> <p>Upon creation, Open Banking Connector will provide you with an ID for the bank registration which you can then use to create consents.</p>"},{"location":"get-started/create-bank-registration/#example-with-postman-and-obie-modelo-model-bank","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/get-account-data/","title":"Get account data","text":"<p>You can get account data once you have created and authorised an account access consent. The ID of the account access consent must be supplied as a header so Open Banking Connector can supply/obtain the correct token for the bank request.</p> <p>In this section, we first get a user's accounts.</p> <p>Once their accounts (and, crucially, bank account IDs) are obtained, we are then able to get account-specific data.</p> <p>We here show getting balances for first user account obtained as an example of how to get account-specific data. Transactions, standing orders, etc may be obtained similarly.</p>"},{"location":"get-started/get-account-data/#get-accounts","title":"Get accounts","text":"<p>We get a user's accounts by specifying the ID of the authorised consent.</p> <p>The data returned will include the external (bank) account IDs which can be used subsequently to retrieve account-specific data.</p>"},{"location":"get-started/get-account-data/#example-with-postman-and-obie-modelo-model-bank","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/get-account-data/#get-balances","title":"Get balances","text":"<p>Using an external (bank) account ID obtained from user accounts, we can obtain the balances associated with an account.</p>"},{"location":"get-started/get-account-data/#example-with-postman-and-obie-modelo-model-bank_1","title":"Example with Postman and OBIE Modelo model bank","text":""},{"location":"get-started/run-docker-image/","title":"Run Docker image","text":"<p>Open Banking Connector Docker images (including the latest) are available here. The Docker images are produced from the Dockerfile in the source code repo. Git tags are used so you can see the exact source code used to create each Docker image.</p> <p>You can pull and run the Open Banking Connector Docker image using a command such as: <pre><code># Substitute env file location and image version in this command\ndocker run -dt --env-file \"&lt;path&gt;/docker.env\" -p 50000:80 --name \"open_banking_connector\" ghcr.io/finlabsuk/open-banking-connector-web-app:x.y.z # substitute version for x.y.z\n</code></pre> where a .env file is used to supply environment variables.</p>"},{"location":"get-started/set-up-configuration-and-secrets/","title":"Set up configuration and secrets","text":"<p>Configuration and secrets are read-only settings supplied to Open Banking Connector that configure its behaviour and supply sensitive information such as transport and signing keys.</p> <p>They can be supplied via environment variables, command line options, or via a supported cloud secrets provider (or any of these in combination).</p> <p>Using environment variables is an attractive option in production because it completely decouples your configuration/secrets from the application. Further, it is often desirable to separate configuration (less sensitive settings) and secrets (more sensitive settings). To achieve this, you could use static environment variables for configuration and for secrets use environment variables dynamically obtained from a secrets vault.</p> <p>In this section, we show how to set up minimal configuration and secrets using environment variables. Note that Open Banking Connector uses the .NET convention of replacing \":\" with \"__\" when environment variables are used. So the configuration setting <code>OpenBankingConnector:Database:Provider</code> is set by the environment variable <code>OpenBankingConnector__Database__Provider</code>.</p>"},{"location":"get-started/set-up-configuration-and-secrets/#1-configure-software-statement-assertions-transportsigningencryption-keys","title":"1. Configure software statement assertions, transport/signing/encryption keys","text":"<p>Software statement assertions (SSAs), transport keys and certs, and signing keys are supplied (alongside related data) to Open Banking Connector by means of:</p> <ul> <li>software statement profiles</li> <li>transport certificate profiles</li> <li>signing certificate profiles</li> </ul> <p>Encryption keys are supplied by means of:</p> <ul> <li>encryption keys</li> </ul> <p>Below are environment variables to set up of one of each of these (the minimum necessary to create a bank registration). You will need to substitute your own values into some of these as noted in the comments. To allow this you will need to create an SSA, a signed OBWAC transport cert and key, and a signed OBSeal signing cert and key using the UK Open Banking Directory and following the instructions there. You will also need to generate a 256-bit encryption key (example code is given here).</p> <pre><code># Software statement profile with ID \"All\"\nOpenBankingConnector__SoftwareStatementProfiles__All__TransportCertificateProfileId=All # instruction to use transport certificate profile with ID \"All\"\nOpenBankingConnector__SoftwareStatementProfiles__All__SoftwareStatement=a.b.c # substitute your software statement assertion (SSA)\nOpenBankingConnector__SoftwareStatementProfiles__All__SigningCertificateProfileId=All # instruction to use signing certificate profile with ID \"All\"\nOpenBankingConnector__SoftwareStatementProfiles__All__DefaultFragmentRedirectUrl=https://example.com/auth/fragment-redirect # substitute your default redirect URL (must match one in your included in your SSA)\n\n# Transport certificate profile with ID \"All\"\nOpenBankingConnector__TransportCertificateProfiles__All__Certificate=\"-----BEGIN CERTIFICATE-----\\nline1\\nline2\\n-----END CERTIFICATE-----\\n\" # substitute your OBWAC transport certificate\nOpenBankingConnector__TransportCertificateProfiles__All__AssociatedKey=\"-----BEGIN PRIVATE KEY-----\\nline1\\nline2\\n-----END PRIVATE KEY-----\\n\" # substitute the key associated with your OBWAC transport certificate\n\n# Signing certificate profile with ID \"All\"\nOpenBankingConnector__SigningCertificateProfiles__All__AssociatedKeyId=xyz # substitute the key ID (kid) associated with your OBSeal signing certificate to allow certificate lookup (obtain the key ID from UK Open Banking Directory)\nOpenBankingConnector__SigningCertificateProfiles__All__AssociatedKey=\"-----BEGIN PRIVATE KEY-----\\nline1\\nline2\\n-----END PRIVATE KEY-----\\n\" # substitute the key associated with your OBSeal signing certificate\n\n# Encryption key with ID \"MyKey\"\nOpenBankingConnector__Keys__CurrentEncryptionKeyId=MyKey\nOpenBankingConnector__Keys__Encryption__MyKey__Value=Q95hOua2S5wXK9W5q/j0+1xIThOSbGhUl2Wano2uTc4= # substitute your base64-encoded 256-bit encryption key (see text for link to example generation code)\n</code></pre>"},{"location":"get-started/set-up-configuration-and-secrets/#2-configure-database-connection","title":"2. Configure database connection","text":"<p>Database settings are described here.</p> <p>Open Banking Connector supports PostgreSQL for production usage.</p> <p>Here are environment variables to configure use of PostgreSQL including specification of a connection string.</p> <pre><code>OpenBankingConnector__Database__Provider=PostgreSql # strictly unnecessary as this is the default\nOpenBankingConnector__Database__EnsureDatabaseCreated=true # suggest temporarily true to allow Open Banking Connector to create database on first use\nOpenBankingConnector__Database__ConnectionStrings__PostgreSql=\"Host=localhost;Database=test;Username=postgres\" # substitute your connection string without password\nOpenBankingConnector__Database__PasswordSettingNames__PostgreSql=OpenBankingConnector:Custom:PostgreSqlPassword # substitute name of environment variable providing database password\nOpenBankingConnector__Custom__PostgreSqlPassword=placeholder # example arbitrary environment variable that supplies database password\n</code></pre>"},{"location":"get-started/set-up-configuration-and-secrets/#3-configure-non-public-bank-profile-information","title":"3. Configure non-public bank profile information","text":"<p>Almost all bank profile information is supplied via source code.</p> <p>However sometimes key information such as org IDs and URLs cannot be obtained from public sources and is only available to those registered with the UK Open Banking Directory or from bank dev portals. This information needs to be provided via configuration to complete the bank profile definitions.</p> <p>Important: It is only necessary to provide information that relates to bank profiles you want to use. When using a bank profile for the first time, if any required information from configuration is not available, Open Banking Connector will provide an error with details.</p> <p>For reference, we list here currently required configuration for supported bank groups.</p> <p>Please contact us if you need any assistance populating these configuration values.</p> <pre><code># Bank group: NatWest (only required if using sandbox bank profiles)\nOpenBankingConnector__BankProfiles__NatWest__RoyalBankOfScotlandSandbox__PaymentInitiationApi__BaseUrl=xx # substitute value\nOpenBankingConnector__BankProfiles__NatWest__RoyalBankOfScotlandSandbox__IssuerUrl=xx # substitute value\nOpenBankingConnector__BankProfiles__NatWest__RoyalBankOfScotlandSandbox__AccountAndTransactionApi__BaseUrl=xx # substitute value\nOpenBankingConnector__BankProfiles__NatWest__NatWestSandbox__PaymentInitiationApi__BaseUrl=xx # substitute value\nOpenBankingConnector__BankProfiles__NatWest__NatWestSandbox__IssuerUrl=xx # substitute value\nOpenBankingConnector__BankProfiles__NatWest__NatWestSandbox__AccountAndTransactionApi__BaseUrl=xx # substitute value\n\n# Bank group: Monzo (only required if using sandbox bank profiles)\nOpenBankingConnector__BankProfiles__Monzo__Monzo__PaymentInitiationApi__ApiVersion=VersionZZ # substitute value\nOpenBankingConnector__BankProfiles__Monzo__Monzo__FinancialId=yy # substitute value\n\n# Bank group: Lloyds\nOpenBankingConnector__BankProfiles__Lloyds__MbnaPersonal__FinancialId=yy # substitute value\nOpenBankingConnector__BankProfiles__Lloyds__LloydsPersonal__FinancialId=yy # substitute value\nOpenBankingConnector__BankProfiles__Lloyds__BankOfScotlandPersonal__FinancialId=yy # substitute value\n\n# Bank group: HSBC\nOpenBankingConnector__BankProfiles__Hsbc__Default__FinancialId=yy # substitute value\n\n# Bank group: Barclays\nOpenBankingConnector__BankProfiles__Barclays__Default__FinancialId=yy # substitute value\n</code></pre>"},{"location":"guide/","title":"Guide","text":"<p>This section provides more information about where Open Banking Connector sits in your architecture and and what it does. It also covers infrastructure requirements.</p>"},{"location":"guide/#where-does-open-banking-connector-sit-in-my-architecture","title":"Where does Open Banking Connector sit in my architecture?","text":"<p>The following diagram shows where Open Banking Connector sits in your architecture:</p> <p></p> <p>Essentially Open Banking Connector runs as a micro-service in your back-end that processes your requests to banks.</p>"},{"location":"guide/#what-does-open-banking-connector-do","title":"What does Open Banking Connector do?","text":""},{"location":"guide/#open-banking-connector-provides-simpler-uk-open-banking-apis","title":"Open Banking Connector provides simpler UK Open Banking APIs","text":"<p>The HTTP APIs provided by Open Banking Connector to your back-end include several that aim to be \"simpler\" versions of their UK Open Banking equivalents such as the Bank Configuration and Account and Transaction APIs.</p> <p>The objective is not to re-design UK Open Banking but rather to simplify things by:</p> <ul> <li>Absorbing bank differences so that you can use the same requests for all banks.</li> <li>Absorbing complexities related to security aspects of Open Banking such as MTLS, tokens, signing etc.</li> </ul> <p>A typical use of Open Banking APIs would be make the following requests:</p> <ol> <li>Create a registration with a bank to establish a relationship</li> <li>Create a consent at the bank and then get an end-user to authorise it</li> <li>Perform API calls relevant to the consent such as retrieving transactions or balances</li> </ol> <p>Please see Get Started for examples of basic operations such as these.</p> <p>The main simplifications for these requests when using Open Banking Connector are as follows:</p> <ul> <li>When creating a bank registration, rather than supply detailed configuration you only need to specify a bank profile and software statement profile. The bank profile associates all of a bank's specific configuration and customisation with the registration and any subsequent consents. The software statement profile ensures the right TPP identity is used when creating the registration.</li> <li>When creating a consent, you supply the bank registration ID (returned when creating the registration) instead of a token and can specify the template \"MaximumPermissions\" instead of needing to know what permissions are supported by a particular bank.</li> <li>When retrieving AISP objects such as transactions etc, you supply the consent ID (returned when creating the consent) instead of a token</li> <li>All data request and response objects are based on a single UK Open Banking spec revision and Open Banking Connector is capable of converting to and from older spec revisions if required for a bank</li> <li>No bank tokens are required as these are obtained, used and refreshed automatically by Open Banking Connector keeping them separate from other parts of your back-end</li> </ul>"},{"location":"guide/#open-banking-connector-supports-end-user-auth-in-your-app","title":"Open Banking Connector supports end-user auth in your app","text":"<p>Open Banking Connector is designed to allow you to support redirection-based authentication in your app. A great deal of information on this is provided by OBIE here.</p> <p>Your app needs to interact with Open Banking Connector both before and after end-user auth.</p> <p>Before end-user auth you need to create a time-sensitive auth context (auth session) in Open Banking Connector. This will remain valid for 10 minutes. If for any reason auth fails or too much time elapses, please create a new auth context before re-attempting auth. For an AISP consent, you can create an auth context using the POST /aisp/account-access-consent-auth-contexts endpoint. Upon creating an auth context, Open Banking Connector will return an auth URL you can redirect the user to. This URL should be used within 5 minutes to avoid signed object expiry.</p> <p>After end-user auth, the bank will redirect to a secure URL your app provides (the redirect URL which can be selected from those in your software statement assertion (SSA) when creating a bank registration). This URL should display appropriate customer messaging and process the bank redirect data in the URL fragment. This redirect data needs to be forwarded by your back-end to Open Banking Connector via the POST /auth/redirect-delegate endpoint. This must occur within the 10-minute lifetime of the auth context.</p> <p>There are many possible scenarios for end-user auth and it is strongly recommended to discuss your planned implementation with us so we can discuss security threat models and best practices.</p>"},{"location":"guide/#open-banking-connector-stores-bank-registration-and-consent-data","title":"Open Banking Connector stores bank registration and consent data","text":"<p>Open Banking Connector uses a database to store information about registrations and consents. This includes encrypted tokens associated with consents and auth session (auth context) information. It does not store or cache end-user transactions, balances etc.</p>"},{"location":"guide/#what-are-open-banking-connectors-infrastructure-requirements","title":"What are Open Banking Connector's infrastructure requirements?","text":"<p>To host Open Banking Connector in your back-end infrastructure, you will need:</p> <ul> <li>a host (e.g. VM or Kubernetes cluster) to run the Open Banking Connector Docker image</li> <li>a relational database. Currently only PosgreSQL is supported in production but, as Open Banking Connector uses EF Core (Microsoft's .NET ORM), other database integrations should be relatively easy to add (for example, SQLite is supported in development environment).</li> <li>a means of supplying configuration/secrets to the Open Banking Connector container. Environment variables can be used and, in the case of secrets, could be e.g. dynamically pulled from a key secret vault. Parameters from AWS SSM Parameter Store can be used and we are open to adding other cloud sources/vaults as required. ASP.NET Core user secrets are supported in development environment.</li> </ul> <p>Sensitive data including encrypted tokens are stored in the database. Thus it should be tightly secured including using at-rest encryption and not allowing access from any other application.</p> <p>Secrets are essentially sensitive configuration settings such as keys. Consideration should be given to the security of these and also issues such as key rotation.</p> <p>Please feel free to discuss with us any issues related to deployment of Open Banking Connector in your back-end infrastructure and in particular any issues related to security.</p>"},{"location":"guide/#what-are-bank-profiles","title":"What are bank profiles?","text":"<p>All bank-specific information, customisations and behaviour is stored in an object called a bank profile. There is one for each bank and sandbox supported by Open Banking Connector and these are maintained to support changes in bank APIs and behaviour.</p> <p>Currently-supported banks and their bank profiles are listed here.</p>"}]}